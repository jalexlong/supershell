# ==============================================================================
# CHAPTER 01: CORE DIAGNOSTICS
# Testing: Sequential Checkpoints, Regex Matching, and Briefing/Debriefing
# ==============================================================================
- id: "DEV_CORE"
  title: "Diagnostic: Core Logic"
  briefing: |
    [DAEMON INITIALIZED]
    Starting Engine Diagnostic Suite.
    Verifying sequential checkpoint progression...
  debriefing: |
    [CORE DIAGNOSTIC COMPLETE]
    Sequential logic is functional. Proceeding to File System diagnostics.
  checkpoints:
    - id: "regex_test"
      name: "Regex Stream"
      instruction: "Verify the shell hook can pass data to the engine."
      objective: "Type: echo ready"
      success: "Regex match: SUCCESS."
      conditions:
        - type: CommandMatches
          pattern: "^echo ready$"

    - id: "logic_test"
      name: "Status Check"
      instruction: "Verify the daemon can handle multiple-word regex."
      objective: "Type: echo system-green"
      success: "Status match: SUCCESS."
      conditions:
        - type: CommandMatches
          pattern: "^echo system-green$"
  next_chapter_id: "DEV_FILESYSTEM"

# ==============================================================================
# CHAPTER 02: FS DIAGNOSTICS
# Testing: File Presence, Content Scanning, and Negative Logic (Missing)
# ==============================================================================
- id: "DEV_FILESYSTEM"
  title: "Diagnostic: File System"
  briefing: |
    [SECTOR 2: FS_PROBE]
    Testing disk read/write permissions and content scanning.
  debriefing: |
    [FS DIAGNOSTIC COMPLETE]
    Engine is 100% Green. Ready for curriculum deployment.
  checkpoints:
    - id: "fs_exists"
      name: "Manifestation"
      instruction: "Verify the engine detects new files in the CWD."
      objective: "Type: touch .dev_probe"
      success: "FileExists: SUCCESS."
      conditions:
        - type: FileExists
          path: ".dev_probe"

    - id: "fs_content"
      name: "Deep Scan"
      instruction: "Verify the engine can read strings inside files."
      objective: "Type: echo 'ALFA_01' > .dev_probe"
      success: "FileContains: SUCCESS."
      conditions:
        - type: FileContains
          path: ".dev_probe"
          pattern: "ALFA_01"

    - id: "fs_missing"
      name: "Purge Logic"
      instruction: "Verify the engine detects file deletion (negative logic)."
      objective: "Type: rm .dev_probe"
      success: "FileMissing: SUCCESS."
      conditions:
        - type: FileMissing
          path: ".dev_probe"
  next_chapter_id: "LAB_01" # End of diagnostic suite

# ==============================================================================
# CHAPTER: LAB 01 - THE HANDSHAKE
# Source: IT&Sec - Lab 01 - The Handshake.md
# Topics: Identity verification, Directory creation, Redirection
# ==============================================================================
- id: "LAB_01"
  title: "Lab 01: The Handshake"
  briefing: |
    [CONNECTION ESTABLISHED]
    [SOURCE: CONTROL]

    Operative, we have detected your signal, but the channel is unsecured.
    Before we proceed with sensitive tasking, we must verify your terminal
    integrity and establish a handshake.

    Do not fail me.
  debriefing: |
    [HANDSHAKE VERIFIED]

    Identity confirmed. Uplink established.
    You are now authorized for further instruction.
    Standing by for Lab 02.
  checkpoints:
    - id: "l1_identity"
      name: "Identity Verification"
      instruction: "Verify your user identity on this terminal."
      objective: "Type: whoami"
      success: "User identity confirmed."
      conditions:
        - type: CommandMatches
          pattern: "^whoami.*"

    - id: "l1_recon"
      name: "Terminal Recon"
      instruction: "Report your terminal's hostname to Control."
      objective: "Type: hostname"
      success: "Hostname logged."
      conditions:
        - type: CommandMatches
          pattern: "^hostname.*"

    - id: "l1_secure_channel"
      name: "Secure Channel"
      instruction: "Create a hidden directory named '.uplink' to store the handshake."
      objective: "Type: mkdir .uplink"
      success: "Secure channel allocated."
      conditions:
        - type: CommandMatches
          pattern: "^mkdir.*\\.uplink"
        - type: FileExists
          path: ".uplink"

    - id: "l1_token_gen"
      name: "Token Generation"
      instruction: "Generate a timestamp token and redirect it into the uplink."
      objective: "Type: date > .uplink/handshake.dat"
      success: "Token generated and stored."
      conditions:
        - type: CommandMatches
          pattern: "^date.*>.*\\.uplink/handshake\\.dat"
        - type: FileExists
          path: ".uplink/handshake.dat"

    - id: "l1_transmit"
      name: "Signal Transmission"
      instruction: "Read the token back to verify the integrity of the data stream."
      objective: "Type: cat .uplink/handshake.dat"
      success: "Transmission received. Content matches."
      conditions:
        - type: CommandMatches
          pattern: "^cat.*\\.uplink/handshake\\.dat"

  next_chapter_id: null # Set to LAB_02 when ready
